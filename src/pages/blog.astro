---
import Layout from '../layouts/Layout.astro'
import PostPreview from '../lib/PostPreview.svelte'

let posts = (await Astro.glob('./blog/**.{md,mdx}'))
  .filter((post) => {
    if (import.meta.env.DEV) return true
    return !post.frontmatter.draft
  })
  .sort(
    (a, b) =>
      new Date(b.frontmatter.datePublished).valueOf() -
      new Date(a.frontmatter.datePublished).valueOf()
  )
---

<Layout title="Austin Crim | blogging for the web">
  <meta
    name="description"
    content="The personal blog of Austin Crim, a web builder"
    slot="og"
  />
  <meta
    name="og:title"
    content="The personal blog of Austin Crim, a web builder"
    slot="og"
  />
  <meta
    name="og:image"
    content="https://austincrim.com/og/blog.png"
    slot="og"
  />
  <meta name="og:url" content="https://austincrim.com" slot="og" />
  <div class="flex flex-col max-w-5xl mx-auto my-20 md:rounded-lg">
    <h3 class="text-4xl text-blue-800">Posts</h3>
    <div class="flex flex-col gap-20 mt-10">
      {
        posts.map((post) => (
          <PostPreview post={{ ...post.frontmatter, url: post.url }} />
        ))
      }
    </div>
  </div>
</Layout>
